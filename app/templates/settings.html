<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>type — Настройки</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=arrow_back_ios" />

    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/settings.css') }}">

    <link rel="icon" href="{{ url_for('static', filename='img/fav.ico') }}" type="image/x-icon">
</head>
<body>
    <div class="cont">
        <div class="settings-block">
            <h2>Настройки</h2>
            <div class="settings-list">
                <div class="setting-item" id="strike" onclick="handleClick('strike')">
                    <span class="setting-name">Страйк</span>
                    {% if settings.strike %}
                        <span class="setting-value on">Включен</span>
                    {% else %}
                        <span class="setting-value off">Выключен</span>
                    {% endif %}
                </div>
                <div class="setting-item" id="notification" onclick="handleClick('notification')">
                    <span class="setting-name">Уведомления</span>
                    {% if settings.notification %}
                        <span class="setting-value on">Включены</span>
                    {% else %}
                        <span class="setting-value off">Выключены</span>
                    {% endif %}
                </div>
                <div class="time-control" id="notification" style="margin-top: {% if settings.notification %}-4px{% else %}-52px{% endif %}">
                    <label for="time-input" class="time-label">Время:</label>
                    <input type="time" id="time-input" class="time-input" value="{{ settings.notification_time.strftime('%H:%M') }}" onchange="handleTimeInput('notification')">
                </div>
                <div class="setting-item" id="day_results" onclick="handleClick('day_results')">
                    <span class="setting-name">Итоги дня</span>
                    {% if settings.strike %}
                        <span class="setting-value on">Включены</span>
                    {% else %}
                        <span class="setting-value off">Выключены</span>
                    {% endif %}
                </div>
                <div class="time-control" id="day_results" style="margin-top: {% if settings.day_results %}-4px{% else %}-52px{% endif %}">
                    <label for="time-input" class="reminder-label">Время:</label>
                    <input type="time" id="time-input" class="time-input" value="{{ settings.day_results_time.strftime('%H:%M') }}" onchange="handleTimeInput('day_results')">
                </div>
                {% if admin %}
                <div class="setting-item" id="admin" onclick="handleClick('admin')">
                    <span class="setting-name">Админка</span>
                    {% if admin == 1 %}
                        <span class="setting-value off">Выключена</span>
                    {% elif admin == 2 %}
                        <span class="setting-value on">Включена</span>
                    {% endif %}
                </div>
                <button class="setting-item filters" onclick="window.parent.location.href = `/filters?referrer=${encodeURIComponent(window.parent.location.pathname)}`">
                    <span class="setting-name">Фильтры</span>
                </button>
                {% endif %}
            </div>
        </div>

        <div class="stats-block">
            <h2>Cтатистика</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-label">Верных</div>
                    <div class="stat-value">{{ stats.correct }}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Ошибок</div>
                    <div class="stat-value">{{ stats.mistakes }}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Скипов</div>
                    <div class="stat-value">{{ stats.skips }}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Процент правильных</div>
                    <div class="stat-value">{{ stats.correct_percent }}%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Среднее время</div>
                    <div class="stat-value">{{ stats.avg_time_per_word }} сек</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Лучшая серия</div>
                    <div class="stat-value">{{ stats.best_streak }}</div>
                </div>
            </div>
            <div class="stats-grid" style="margin-top: 24px;">
                {% if admin %}
                <div class="stat-item">
                    <div class="stat-label">Размечено объяснений</div>
                    <div class="stat-value">{{ stats.explanations }}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Пользователей</div>
                    <div class="stat-value">{{ stats.users }}</div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="{{ url_for('static', filename='js/applyColorTheme.js') }}"></script>
    <script src="{{ url_for('static', filename='js/settings.js') }}"></script>
</body>
</html>